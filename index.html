<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #74ebd5, #ACB6E5);
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      max-width: 600px;
      width: 100%;
    }
    h2 {
      text-align: center;
    }
    .search-box {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }
    input {
      flex: 1;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 10px;
    }
    button {
      padding: 10px 15px;
      margin-left: 10px;
      border: none;
      background: #007BFF;
      color: white;
      border-radius: 10px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    .weather-info, .forecast {
      margin-top: 20px;
      text-align: center;
    }
    .forecast-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 10px;
    }
    .card {
      background: #f4f4f4;
      border-radius: 10px;
      padding: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üå¶Ô∏è Weather Dashboard</h2>
    <div class="search-box">
      <input type="text" id="cityInput" placeholder="Enter city name">
      <button onclick="getWeather()">Search</button>
      <button onclick="getLocationWeather()">üìç</button>
    </div>
    <div id="weatherInfo" class="weather-info"></div>
    <div id="forecast" class="forecast"></div>
  </div>

  <script>
    const apiKey = "e11764b85dec6b96452a12388531dbef"; // üîë Replace with your OpenWeather API key

    // Fetch weather by city name
    async function getWeather() {
      const city = document.getElementById("cityInput").value;
      if (!city) {
        alert("Please enter a city name!");
        return;
      }
      fetchWeatherData(city);
    }

    // Fetch weather using geolocation
    function getLocationWeather() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(async position => {
          const { latitude, longitude } = position.coords;
          const geoRes = await fetch(`https://api.openweathermap.org/geo/1.0/reverse?lat=${latitude}&lon=${longitude}&limit=1&appid=${apiKey}`);
          const geoData = await geoRes.json();
          if (geoData.length > 0) {
            fetchWeatherData(geoData[0].name);
          }
        }, () => {
          alert("Geolocation access denied!");
        });
      } else {
        alert("Geolocation not supported by this browser.");
      }
    }

    // Fetch current weather + forecast
    async function fetchWeatherData(city) {
      try {
        // Geocoding to get lat/lon
        const geoRes = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${city}&limit=1&appid=${apiKey}`);
        if (!geoRes.ok) throw new Error("Geocoding failed");
        const geoData = await geoRes.json();
        if (geoData.length === 0) {
          document.getElementById("weatherInfo").innerHTML = "‚ùå City not found!";
          return;
        }
        const { lat, lon, name, country } = geoData[0];

        // Current weather
        const weatherRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`);
        if (!weatherRes.ok) throw new Error("Weather fetch failed");
        const weatherData = await weatherRes.json();

        document.getElementById("weatherInfo").innerHTML = `
          <h3>${name}, ${country}</h3>
          <p>üå°Ô∏è Temp: ${weatherData.main.temp} ¬∞C</p>
          <p>üíß Humidity: ${weatherData.main.humidity}%</p>
          <p>üí® Wind: ${weatherData.wind.speed} m/s</p>
          <p>‚òÅÔ∏è ${weatherData.weather[0].description}</p>
          <img src="http://openweathermap.org/img/wn/${weatherData.weather[0].icon}@2x.png" alt="icon">
        `;

        // 5-day forecast (3-hour intervals, take every 8th = 1 per day)
        const forecastRes = await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`);
        const forecastData = await forecastRes.json();

        let forecastHTML = "<h3>5-Day Forecast</h3><div class='forecast-cards'>";
        for (let i = 0; i < forecastData.list.length; i += 8) {
          const day = forecastData.list[i];
          const date = new Date(day.dt_txt).toLocaleDateString();
          forecastHTML += `
            <div class="card">
              <h4>${date}</h4>
              <p>üå°Ô∏è ${day.main.temp} ¬∞C</p>
              <p>${day.weather[0].description}</p>
              <img src="http://openweathermap.org/img/wn/${day.weather[0].icon}.png" alt="icon">
            </div>
          `;
        }
        forecastHTML += "</div>";
        document.getElementById("forecast").innerHTML = forecastHTML;

      } catch (error) {
        console.error(error);
        document.getElementById("weatherInfo").innerHTML = "‚ö†Ô∏è Error fetching weather data!";
      }
    }
  </script>
</body>
</html>
